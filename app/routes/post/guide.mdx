---
title: 项目技术架构指南
desc: 项目技术架构指南
date: 2025-08-18
---

本文档旨在介绍 chuanplus-web 项目的技术架构和核心组件选择的原因，帮助新团队成员快速了解项目的技术栈和设计决策。

## 1. Rsbuild 构建工具

### 1.1 为什么选择 Rsbuild？

Rsbuild 是一个基于 Rspack 的现代化构建工具，具有以下优势：

1. **快速构建**: 基于 Rust 的 Rspack 内核，构建速度比 Webpack 快 10 倍以上
2. **开箱即用**: 提供了现代 Web 开发所需的大部分功能，无需繁琐配置
3. **生态兼容**: 兼容 Webpack 生态，可以使用大部分 Webpack 插件
4. **易于扩展**: 提供了丰富的插件系统，可以轻松扩展功能

### 1.2 项目中的 Rsbuild 配置

在 `rsbuild.config.ts` 中，我们配置了以下功能：

1. **插件系统**:
   - `pluginReact`: React 支持
   - `pluginBabel`: Babel 支持，用于 React Compiler
   - `pluginSvgr`: SVG 组件支持
   - `pluginNodePolyfill`: Node.js 模块 polyfill

2. **路径别名**:
   - 设置了 `@` 指向 `src` 目录，方便模块导入

3. **开发服务器**:
   - 端口设置为 5033
   - 配置了 API 代理，解决开发环境跨域问题

4. **性能优化**:
   - 在生产环境中移除 `console.log` 和 `console.warn`
   - 使用经验策略进行代码分割
   - 集成了 Rsdoctor 进行构建分析

5. **TanStack Router 集成**:
   - 使用 `TanStackRouterRspack` 插件实现自动代码分割

## 2. TanStack Router 路由系统

### 2.1 为什么选择 TanStack Router？

TanStack Router 是一个类型安全、高性能的 React 路由库，相比 React Router 具有以下优势：

1. **类型安全**: 提供端到端的类型安全性，路由参数、搜索参数等都有完整的类型推导
2. **文件式路由**: 支持基于文件系统的路由组织，更直观和易于维护
3. **自动代码分割**: 支持基于路由的代码分割，提高应用加载性能
4. **嵌套路由**: 强大的嵌套路由支持，便于构建复杂的布局结构
5. **预加载**: 支持路由预加载，提升用户体验

### 2.2 项目中的路由配置

1. **路由配置文件**:
   - `tsr.config.json`: 定义路由目录、生成路由树文件、忽略文件模式等

2. **路由结构**:
   - 使用文件系统组织路由，如 `src/routes/operation-manage` 对应 `/operation-manage` 路径
   - 特殊文件名规则:
     - 以短横线开头的文件不会被路由
     - 特定后缀的文件不会被路由（如 modal.tsx, drawer.tsx）

3. **根路由**:
   - 在 `__root.tsx` 中实现了全局布局和权限控制
   - 集成了路由守卫，未登录用户将重定向到登录页

4. **路由特性**:
   - 默认启用预加载 (`defaultPreload: 'intent'`)
   - 启用滚动恢复 (`scrollRestoration: true`)
   - 配置了默认的错误和未找到组件

## 3. Jotai 状态管理和 Ahooks 应用

### 3.1 Jotai 状态管理

#### 为什么选择 Jotai？

Jotai 是一个原始的、面向 TypeScript 的状态管理库，具有以下优势：

1. **原子化设计**: 状态被分解为小的原子单元，便于组合和复用
2. **类型安全**: 提供完整的 TypeScript 支持
3. **简洁 API**: API 简单直观，学习成本低
4. **无样板代码**: 相比 Redux 等方案，不需要编写大量样板代码
5. **React 原生**: 利用 React 的 Context 和 Hooks，与 React 生态完美融合

#### 项目中的应用

1. **状态原子**:
   - 在 `src/atoms` 目录中定义状态原子
   - 如 `userInfoAtom`, `userMenuAtom` 等全局状态

2. **使用方式**:

   ```tsx
   import { useAtom } from "jotai";
   import { userInfoAtom } from "@/atoms/app";

   const [userInfo, setUserInfo] = useAtom(userInfoAtom);
   ```

### 3.2 Ahooks 应用

#### 为什么选择 Ahooks？

Ahooks 是一个高质量和可靠的 React Hooks 库，提供了以下价值：

1. **丰富功能**: 提供了大量实用的 Hooks，涵盖网络请求、状态管理、生命周期等
2. **质量保证**: 经过大量项目验证，稳定可靠
3. **类型安全**: 完整的 TypeScript 支持
4. **按需引入**: 可以按需引入需要的 Hooks，减少打包体积

#### 项目中的应用

项目中主要使用 Ahooks 来简化常见的 React 开发模式，如：

1. 网络请求状态管理
2. 表单处理
3. 设备状态检测
4. 性能优化 Hooks

## 4. UI 组件库选择：Ant Design 和 Shadcn UI

### 4.1 为什么同时使用两套 UI 组件库？

在 chuanplus-web 项目中，我们同时使用了 Ant Design 和 Shadcn UI 两套组件库，这是基于以下考虑：

#### Ant Design 的优势

1. **企业级组件**: 提供了丰富的企业级管理后台组件
2. **成熟稳定**: 经过多年发展，功能完善且稳定
3. **文档完善**: 拥有详细的文档和大量示例
4. **生态丰富**: 有大量第三方组件和工具支持

#### Shadcn UI 的优势

1. **设计现代**: 基于 Radix UI 和 Tailwind CSS，设计风格现代化
2. **高度可定制**: 通过 Tailwind CSS 可以轻松定制组件样式
3. **轻量级**: 按需引入，无额外运行时依赖
4. **易于扩展**: 组件代码可直接复制到项目中进行修改

### 4.2 使用策略

1. **Ant Design 作为主组件库**:
   - 用于构建主要的业务界面
   - 处理复杂的表单、表格、数据展示等场景

2. **Shadcn UI 作为补充**:
   - 用于特定场景下的定制化组件
   - 利用其现代化的设计风格提升用户体验
   - 用于一些简单的 UI 元素，如按钮、卡片等

### 4.3 样式系统

项目采用了 Tailwind CSS 作为主要的样式方案，这使得：

1. **统一的样式系统**: 所有组件风格保持一致
2. **易于定制**: 通过 Tailwind 的配置可以轻松定制主题
3. **响应式设计**: 内置响应式支持，适配不同设备

## 5. 其他技术选型

### 5.1 React 19

项目使用了最新的 React 19 版本，享受了以下新特性：

1. **性能提升**: 更好的渲染性能和内存使用
2. **新 Hooks**: 如 `useOptimistic`, `useFormStatus` 等
3. **Actions**: 改进了表单处理和服务器操作

### 5.2 TypeScript

项目采用 TypeScript 进行类型检查，确保代码质量：

1. **严格的类型检查**: 配置了严格的 TypeScript 编译选项
2. **路径映射**: 使用 `@/*` 路径别名简化模块导入
3. **类型安全**: 与 TanStack Router 结合提供端到端类型安全

### 5.3 开发工具链

1. **ESLint**: 代码质量检查
2. **Prettier**: 代码格式化
3. **React Compiler**: React 组件优化编译器
4. **Rsdoctor**: 构建分析工具

## 6. 项目规范

### 6.1 文件命名规范

项目采用 kebab-case 命名规则：

- 所有文件名使用小写字母
- 单词之间使用连字符（-）分隔
- 例如：`user-profile.tsx`, `auth-service.ts`

### 6.2 路由规范

1. **文件式路由**: 基于文件系统自动生成路由
2. **特殊文件名**:
   - 以短横线开头的文件不会被路由
   - 特定后缀的文件不会被路由

## 7. 总结

chuanplus-web 项目采用了现代化的前端技术栈，结合了各种工具和库的优势：

1. **构建工具**: Rsbuild 提供快速、稳定的构建体验
2. **路由系统**: TanStack Router 提供类型安全的路由管理
3. **状态管理**: Jotai 提供简洁的状态管理方案
4. **UI 组件**: Ant Design 和 Shadcn UI 相结合，满足不同场景需求
5. **开发体验**: TypeScript、ESLint、Prettier 等工具保证代码质量

这套技术架构既保证了开发效率，又确保了项目的可维护性和可扩展性，适合构建复杂的企业级 Web 应用。
